{% extends 'tpl/base/base.html' %}
{% load assets %}

{% block title %}{{ title }}{% endblock %}

{% block content %}

<div class="cwg-container">
    <div class="container breadcrumb-container">
        <ol class="breadcrumb">
          <li><a href="/">首页</a></li>
          <li class="active">我要买狗</li>
        </ol>
    </div>
    <div class="container buy-main content-container">
        <div class="row">
            <div class="col-6 col-offset-1">
                <form action="{{ urls }}{{ directkey }}/{{ typekey }}/{{ princekey }}/{{ agekey }}/{{ epidemickey }}/{{ searchkey }}/1/" method="get" id="js-form">
                    <div class="input-group cwg-search-wrap">
                    	<input type="text" class="form-control" id="js-key" placeholder="输入养殖场名称、所处区县等" name="key" {% if searchkey != 'all' %}value="{{ searchkey }}"{% endif %}>
                        <span class="input-group-btn">
                            <button class="btn btn-search" type="submit">
                                <i class="icon icon-search"></i>
                            </button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">犬种：</div>
            <div class="col-11">
                <ul class="nav nav-pills">
                	{% if typekey == 'all'%}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-all-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-all-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% endif %}
                    {% for type in types %}
                    {% if type == typekey %}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ type }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ type }}</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ type }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ type }}</a></li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">价格：</div>
            <div class="col-11">
                <ul class="nav nav-pills">
                	{% if princekey == '0' %}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-0-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-0-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% endif %}
                    {% for prince in princes %}
                    {% if prince.a == princekey %}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ prince.a }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ prince.d }}</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ prince.a }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ prince.d }}</a></li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">区域：</div>
            <div class="col-11">
                <ul class="nav nav-pills">
                	{% if directkey == 'all'%}
                    <li class="active"><a href="{{ urls }}all-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% else %}
                    <li><a href="{{ urls }}all-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% endif %}
                    {% for direct in directs %}
                    {% if direct == directkey %}
                    <li class="active"><a href="{{ urls }}{{ direct }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">城{{ direct }}</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ direct }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-1/">城{{ direct }}</a></li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">疫苗：</div>
            <div class="col-11">
                <ul class="nav nav-pills">
                	{% if epidemickey == 'all'%}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-all-{{ searchkey }}-1/">全部</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-all-{{ searchkey }}-1/">全部</a></li>
                    {% endif %}
                    {% for epidemic in epidemics %}
                    {% if epidemic == epidemickey %}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemic }}-{{ searchkey }}-1/">{{ epidemic }}</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemic }}-{{ searchkey }}-1/">{{ epidemic }}</a></li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">月龄：</div>
            <div class="col-11">
                <ul class="nav nav-pills">
                	{% if agekey == '0'%}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-0-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-0-{{ epidemickey }}-{{ searchkey }}-1/">全部</a></li>
                    {% endif %}
                    {% for age in ages %}
                    {% if age.a == agekey %}
                    <li class="active"><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ age.a }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ age.d }}</a></li>
                    {% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ age.a }}-{{ epidemickey }}-{{ searchkey }}-1/">{{ age.d }}</a></li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% if searchkey == 'all' and  typekey == 'all' and princekey == '0' and directkey == 'all' and epidemickey == 'all' and agekey == '0' %}
        {% else %}
        <div class="row dog-select-row">
            <div class="col-1 dog-select-title">筛选：</div>
            <div class="col-11">
                <ul class="nav nav-pills dog-selected">
                	{% if searchkey == 'all' %}
                	{% else %}
                	<li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-all-{{ curpage }}/">{{ searchkey }} &times;</a></li>
                	{% endif %}
                	{% if typekey == 'all' %}
                	{% else %}
                    <li><a href="{{ urls }}{{ directkey }}-all-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ curpage }}/">{{ typekey }} &times;</a></li>
                    {% endif %}
                    {% if princekey == '0' %}
                	{% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-0-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ curpage }}/">价格 &times;</a></li>
                    {% endif %}
                    {% if directkey == 'all' %}
                	{% else %}
                    <li><a href="{{ urls }}all-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ curpage }}/">城{{ directkey }} &times;</a></li>
                    {% endif %}
                    {% if epidemickey == 'all' %}
                	{% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-all-{{ searchkey }}-{{ curpage }}/">{{ epidemickey }} &times;</a></li>
                    {% endif %}
                    {% if agekey == '0' %}
                	{% else %}
                    <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-0-{{ epidemickey }}-{{ searchkey }}-{{ curpage }}/">月龄 &times;</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
        {% endif %}
{#        <div class="row-separate row"></div>#}
        <div class="clearfix buy-tabs">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#home">认证犬舍</a></li>
                <li><a href="#home">养殖场</a></li>
                <li><a href="#home">个人繁育</a></li>
            </ul>
        </div>
        <div class="row dog-list">
            {% if pets_imgs%}
                {% for pet_img in pets_imgs %}
                <div class="col-4 dog-list-item">
                    <a href="{{ urls }}detail/{{ pet_img.pet.id }}/">
                        <img src="{{ 'imgs/loading.gif'|assets }}" data-original="{{ pet_img.img.img_url }}" class="img-full js-lazy" alt="{{ pet_img.pet.farm.name }}-{{ pet_img.pet.short_desc }}"/>
                    </a>
                    <div class="dog-desc">
                        <h4><a href="{{ urls }}detail/{{ pet_img.pet.id }}/"><strong>[{{ pet_img.pet.farm.name }}]</strong> {{ pet_img.pet.short_desc }}</a></h4>
                        <div>
                            <label class="pet-tag">{{ pet_img.pet.age }}个月</label>
{#                            <label class="pet-tag">{{ pet_img.count }}只</label>#}
                            <label class="pet-tag">{{ pet_img.epidemic }}</label>
                        </div>
                        <p>
                            <span class="price price-primary"><span class="price-symbol">&yen;</span>{{ pet_img.min_price }}<span class="price-desc">元/只</span></span>
                            <a href="{{ urls }}detail/{{ pet_img.pet.id }}/" class="btn btn-primary pull-right btn-dog" role="button">去看看</a>
                        </p>
                    </div>
                </div>
                {% if forloop.counter|divisibleby:3 %}<div class="clearfix"></div>{% endif %}
                {% endfor %}
                <div class="clearfix"></div>
                <div class="text-center">
                    <ul class="pagination pagination-primary">
                        {% if curpage <= 1 %}
                        <li class="disabled"><span>首页</span></li>
                        <li class="disabled"><span>上一页</span></li>
                        {% else %}
                        <li><a href="/buy/">首页</a></li>
                        <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ pageup }}/">上一页</a></li>
                        {% endif %}
                        {% for page in pages %}
                        {% if page == curpage %}
                        <li class="active"><span>{{ page }}</span></li>
                        {% else %}
                        <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ page }}/">{{ page }}</a></li>
                        {% endif %}
                        {% endfor %}
                        {% if curpage >=  allpage%}
                        <li class="disabled"><span>下一页</span></li>
                        <li class="disabled"><span>尾页</span></li>
                        {% else %}
                        <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ pagedown }}/">下一页</a></li>
                        <li><a href="{{ urls }}{{ directkey }}-{{ typekey }}-{{ princekey }}-{{ agekey }}-{{ epidemickey }}-{{ searchkey }}-{{ allpage }}/">尾页</a></li>
                        {% endif %}
                     </ul>
                </div>
            {% else %}
                <div class="col-12">
                    <p class="text-center no-result">没有找到符合条件的宠物</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
(function(){
    var $form = $('#js-form'),
        $key = $form.find('#js-key');

    $form.on('submit', function(e){
        if($.trim($key.val()) == ''){
            $key.focus();
            e.preventDefault();
        }
    });
}());
</script>
{% endblock %}